<!DOCTYPE html
    PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"
   >
<html>
    <head>
        <title>App4Sea</title>
        
        <link rel="icon" href="favicon.ico"/>        

        <script src="https://cdnjs.cloudflare.com/ajax/libs/ol3/3.10.1/ol.min.js" type="text/javascript"></script>
        
        <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>        
        <meta http-equiv="X-UA-Compatible" content="IE=edge"/>

        <link href="https://fonts.googleapis.com/css?family=Montserrat" rel="stylesheet"/> 
        <link rel="stylesheet" href="https://www.w3schools.com/w3css/4/w3.css"/>

        <script src="jquery/jquery-3.2.1.min.js" type="text/javascript"></script>

        <link href="jquery/jquery-ui.min.css" rel="stylesheet" type="text/css"/>
        <script src="jquery/jquery-ui.min.js" type="text/javascript"></script>

        <link href="jquery/jquery.growl.css" rel="stylesheet" type="text/css" />
        <script src="jquery/jquery.growl.js" type="text/javascript"></script>

        <script src="static/js/mustache.js" type="text/javascript"></script>
        
        <!-- https://medialize.github.io/URI.js/ -->
        <script src="static/js/URI.js" type="text/javascript"></script>
        <!-- https://github.com/webcomponents/webcomponentsjs/ -->
        <script src="static/js/webcomponents-bundle.js" type="text/javascript"></script>

        <script src="static/js/qwest.min.js" type="text/javascript"></script>
        <script src="static/js/zip.js" type="text/javascript"></script>
        <!--script src="static/js/cors-public.js" type="text/javascript"></script-->
        
        <script type="text/javascript">
            "use strict";

            $(document).ready(function () {

                $(".MenuItem").click(function () {
                    var url = $(this).attr("data-url");
                    var target = $(this).attr("data-target");
                    window.open(url, target);
                });
            });

            // https://hibbard.eu/display-ui-blocking-overlay-on-page-load/
            $(window).on('load', function() {
                $.fn.center = function () {
                  this.css("position", "absolute");
                  this.css("top", Math.max(0, (
                    ($(window).height() - $(this).outerHeight()) / 2) + 
                     $(window).scrollTop()) + "px"
                  );
                  this.css("left", Math.max(0, (
                    ($(window).width() - $(this).outerWidth()) / 2) + 
                     $(window).scrollLeft()) + "px"
                  );
                  return this;
                };

                $("#overlay").show();
                $("#overlay-content").show().center();

                setTimeout(function(){    
                  $("#overlay").fadeOut();
                }, 2000);
            });
        </script>

        <!-- OpenLayers begin -->
        <!--link rel="stylesheet" href="https://openlayers.org/en/v4.6.4/css/ol.css" type="text/css"/>
        <script src="https://openlayers.org/en/v4.6.4/build/ol.js" type="text/javascript"></script-->
        <script type="text/javascript" src="https://cdn.rawgit.com/openlayers/openlayers.github.io/master/en/v5.1.3/build/ol.js"></script>
        <link rel="stylesheet" href="https://cdn.rawgit.com/openlayers/openlayers.github.io/master/en/v5.1.3/css/ol.css"/>
            
        <!-- OpenWeatherMaps widget -->
        <script type="text/javascript" src="http://openweathermap.org/themes/openweathermap/assets/vendor/owm/js/d3.min.js"></script>
        
        <!--script src="scripts/App4Sea.KmzHandler.js" type="text/javascript"></script-->
        <script src="scripts/App4Sea.Map.OpenLayers.js" type="text/javascript"></script>
        <!-- OpenLayers end -->

        <link href="css/main.css" rel="stylesheet" type="text/css" />
        
        <!-- The line below is only needed for old environments like Internet Explorer and Android 4.x -->
        <!-- This will not work anyway in IE. And it will render coordinates for kml files as 0,0 -->
        <!--script src="https://cdn.polyfill.io/v2/polyfill.min.js?features=requestAnimationFrame,Element.prototype.classList,URL"></script>
        <script src="https://openlayers.org/en/v4.6.5/build/ol.js"></script-->

        <link rel="stylesheet" href="static/js/dist/themes/default/style.min.css" />
        <script src="static/js/dist/jstree.min.js" type="text/javascript"></script>
        
        <!-- Latest compiled and minified CSS -->
        <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css"/>

        <!-- Optional theme -->
        <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap-theme.min.css"/>

        <!-- Latest compiled and minified JavaScript -->
        <script src="//maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" type="text/javascript"></script>

        <script id="RescueSite" type="text/template">
            <div style="margin:2px;">
                <h3>{{name}}</h3>
                <p>{{address}}</p>
                <p>{{region}}</p>
                <p>{{region2}}</p>
                <p>{{region3}}</p>
                <p>{{region4}}</p>
                <p>{{{link}}}</p>
            </div>
        </script>
        
        <script id="ShipInfo" type="text/template">
            <div style="margin:2px;">                
                <h3>{{name}}</h3>
                <p>{{callsign}}</p>
                <p>{{type}}</p>
                <p>{{cargotype}}</p>
                <p>{{flag}}</p>
            </div>
        </script>
        
        <script id="DefaultPop" type="text/template">
            <div style="margin:2px;">
                <p>{{description}}</p>
            </div>
        </script>
        
        <style>

          #ToolTipInfo {
            position: absolute;
            height: 1px;
            width: 1px;
            z-index: 100;
          }
          .tooltip.in {
            opacity: 1;
            filter: alpha(opacity=100);
          }
          .tooltip.top .tooltip-arrow {
            border-top-color: white;
          }
          .tooltip-inner {
            border: 2px solid white;
          }

            #overlay{
                /*display: none;*/
                position: fixed;
                top: 0%;
                left: 0%;
                width: 100%;
                height: 100%;
                background-color: black;
                opacity: 0.8;
                z-index:10001;
            }

            #overlay-content{ 
                position: absolute;
                display: none;
                width: 80%;
                padding: 0px;
                border: 0px white;
                background-color: white;
                opacity: 1.0;
                z-index:10002;
            }        

          .ol-popup {
            position: absolute;
            background-color: white;
            -webkit-filter: drop-shadow(0 1px 4px rgba(0,0,0,0.2));
            filter: drop-shadow(0 1px 4px rgba(0,0,0,0.2));
            border-radius: 10px;
            border: 1px solid #cccccc;
            bottom: 12px;
            left: -50px;
            min-width: 200px;
            width: auto;
            padding-top:20px;
          }
          .ol-popup:after, .ol-popup:before {
            top: 100%;
            border: solid transparent;
            content: " ";
            height: 0;
            width: 0;
            position: absolute;
            pointer-events: none;
          }
          .ol-popup:after {
            border-top-color: white;
            border-width: 10px;
            left: 48px;
            margin-left: -10px;

            content: "";
            display: table;
            clear: both;
          }
          .ol-popup:before {
            border-top-color: #cccccc;
            border-width: 11px;
            left: 48px;
            margin-left: -11px;
          }
          .ol-popup-closer {
            text-decoration: none;
            position: absolute;
            top: 2px;
            right: 8px;
          }
          .ol-mouse-position {
            right: 4.5em;
          }
          .ol-scale-line {
            left: 14.5em;
          }
        .ol-popup-closer:after {
          content: "✖";
        }

          input[type=range] {
            -webkit-appearance: none;
            width: 100%;
            margin: 4px 0;
          }
          input[type=range]:focus {
            outline: none;
          }
          input[type=range]::-webkit-slider-runnable-track {
            width: 100%;
            height: 2px;
            cursor: pointer;
            box-shadow: 0px 0px 0px rgba(0, 0, 0, 0.5), 0px 0px 0px rgba(13, 13, 13, 0.5);
            background: #000000;
            border-radius: 0px;
            border: 0px solid #ffffff;
          }
          input[type=range]::-webkit-slider-thumb {
            box-shadow: 2.3px 2.3px 7.5px #000000, 0px 0px 2.3px #0d0d0d;
            border: 0px solid #000000;
            height: 10px;
            width: 5px;
            border-radius: 0px;
            background: #ffc864;
            cursor: pointer;
            -webkit-appearance: none;
            margin-top: -4px;
          }
          input[type=range]:focus::-webkit-slider-runnable-track {
            background: #000000;
          }
          input[type=range]::-moz-range-track {
            width: 100%;
            height: 2px;
            cursor: pointer;
            box-shadow: 0px 0px 0px rgba(0, 0, 0, 0.5), 0px 0px 0px rgba(13, 13, 13, 0.5);
            background: #000000;
            border-radius: 0px;
            border: 0px solid #ffffff;
          }
          input[type=range]::-moz-range-thumb {
            box-shadow: 2.3px 2.3px 7.5px #000000, 0px 0px 2.3px #0d0d0d;
            border: 0px solid #000000;
            height: 10px;
            width: 10px;
            border-radius: 0px;
            background: #ffc864;
            cursor: pointer;
          }
          input[type=range]::-ms-track {
            width: 100%;
            height: 2px;
            cursor: pointer;
            background: transparent;
            border-color: transparent;
            color: transparent;
          }
          input[type=range]::-ms-fill-lower {
            background: #000000;
            border: 0px solid #ffffff;
            border-radius: 0px;
            box-shadow: 0px 0px 0px rgba(0, 0, 0, 0.5), 0px 0px 0px rgba(13, 13, 13, 0.5);
          }
          input[type=range]::-ms-fill-upper {
            background: #000000;
            border: 0px solid #ffffff;
            border-radius: 0px;
            box-shadow: 0px 0px 0px rgba(0, 0, 0, 0.5), 0px 0px 0px rgba(13, 13, 13, 0.5);
          }
          input[type=range]::-ms-thumb {
            box-shadow: 2.3px 2.3px 7.5px #000000, 0px 0px 2.3px #0d0d0d;
            border: 0px solid #000000;
            height: 10px;
            width: 10px;
            border-radius: 0px;
            background: #ffc864;
            cursor: pointer;
            height: 2px;
          }
          input[type=range]:focus::-ms-fill-lower {
            background: #000000;
          }
          input[type=range]:focus::-ms-fill-upper {
            background: #000000;
          }

            .clearfix::after { 
               content: " ";
               display: block; 
               height: 0; 
               clear: both;
            }
        </style>
    </head>
    
    <body>
        <!-- Splash overlay -->
        <div id="overlay">
            <div id="overlay-content">
                <img src="images/PosterHor.jpg" alt="App4Sea is an NPA-project" style="width:100%;" />
            </div>
        </div>
        
        <!-- This is the left side menu container -->
        <div id="MenuContainer" class="w3-sidebar w3-bar-block" style="display:none"> 
            <div style="background-color:white; display:inline-block; width:100%;">
                <button onclick="section_toggle('MenuContainer')" class="w3-button w3-white" style="float:left; font-weight:bold; padding-left:0px; padding-right:3px; ">
                    <img src="icons/CloseMenu.png" alt="Close menu" style="width:1em;" />
                </button>
                <button onclick="section_toggle('InfoContainer')" class="w3-button w3-white" style="float:left; font-weight:bold; padding-left:3px; padding-right:3px; ">
                    <img src="icons/info.png" alt="Information" style="width:1em;" />
                </button>
                <button onclick="section_toggle('SettingsContainer')" class="w3-button w3-white" style="float:left; font-weight:bold; padding-left:3px; padding-right:3px; ">
                    <img src="icons/settings.png" alt="Settings" style="width:1.1em;" />
                </button>
                <button onclick="section_toggle('AnimationContainer')" class="w3-button w3-white" style="float:left; font-weight:bold; padding-left:3px; padding-right:3px; ">
                    <img src="icons/animation.png" alt="Animation" style="width:1.1em;" />
                </button>
                <!--button id="testBtn" class="w3-button w3-white" style="float:left; font-weight:bold; padding-left:0px; padding-right:3px; ">Test</button-->
                <button onclick="w3_close('MenuContainer')" class="w3-button w3-white" style="float:right; font-weight:bold; padding-left:3px; padding-right:0px; ">x</button>
            </div>
            <div>
                <a href="http://app4sea.interreg-npa.eu">
                    <img src="images/App4Sea.jpg" alt="App4Sea is an NPA-project" style="width:100%;"/>
                </a>
            </div>
            
            <div id='InfoContainer' class="MenuSection" style="background-color:lightgrey; display:none">
                <button onclick="w3_close('InfoContainer')" class="w3-button w3-white" style="float:right; font-weight:bold">x</button>
                <h4>Information</h4>

                <div style="font-size:0.8em; color:red">
                    This site currently works best in the Chrome and Vivaldi browsers.<br/>
                    <!--To access cross domain information please add 
                    <a href='https://chrome.google.com/webstore/detail/allow-cors-access-control/lhobafahddgcelffkeicbaginigeejlf?brand=CHBD&gclid=EAIaIQobChMIxsz1iebz3AIVwcDACh3yDgHbEAAYASABEgKjnvD_BwE&gclsrc=aw.ds&dclid=CNTTwZHm89wCFdQm4AodmP0Obw' title='Allow CORS'> 
                            this extension
                    </a> to those browsers.
                    -->
                </div>
            </div>
            
            <div id='SettingsContainer' class="MenuSection" style="background-color:lightgrey; display:none">
                <button onclick="w3_close('SettingsContainer')" class="w3-button w3-white" style="float:right; font-weight:bold">x</button>
                <h4>Settings</h4>

                <h5>Base map</h5>
                <div class="MenuSection">
                    <select id="MenuLayer_Select" >
                        <option value="esriWSPTileLayer">ESRI World Street Map</option>
                        <option value="esriWITileLayer">ESRI World Imagery Map</option>
                        <option value="osmTileLayer">Open Street Map</option>
                        <option value="blackTileLayer">Carto DB Dark Matter Map</option>
                    </select>
                </div>
                
                <h5>Heatmap settings</h5>
                <div class="MenuSection" style="background-color: grey">
                    <div style="font-size:0.6em; color:white">
                        <form>
                            <table width="100%">
                                <tr style="text-align:center">
                                    <td colspan="4">
                                        <span id="titleHeatMap">title</span>
                                    </td>
                                </tr>
                                <tr>
                                    <td colspan="4">
                                        <br/>
                                    </td>
                                </tr>
                                <tr>
                                    <td style="text-align:right">
                                        <label>Radius Size</label>
                                    </td>
                                    <td>
                                        <input id="radius" type="range" min="1" max="50" step="1" value="5"/>
                                    </td>
                                    <td style="text-align:right">
                                        <label>Blur Size</label>
                                    </td>
                                    <td>
                                        <input id="blur" type="range" min="1" max="50" step="1" value="15"/>
                                    </td>
                                </tr>
                            </table>
                        </form>
                    </div>
                </div>
            </div>

            <div id='AnimationContainer' class="MenuSection" style="background-color:lightgrey; display:none">
                <button onclick="w3_close('AnimationContainer')" class="w3-button w3-white" style="float:right; font-weight:bold">x</button>

                <h4>Animation</h4>
                <div class="MenuSection">
                    <div style="font-size:0.6em; color:white; background-color:grey;">
                        <form>
                            <table width="100%">
                                <tr style="text-align:center">
                                    <td colspan="4">
                                        <span id="title">title</span>
                                    </td>
                                </tr>
                                <tr>
                                    <td>
                                        <button id="playStop" type="button" style="font-size:0.5em; color: Grey;">Play</button>
                                    </td>
                                    <td colspan="3">
                                        <input id="progress" type="range" min="0" max="99" step="1" value="0"/>
                                    </td>
                                </tr>
                                <tr>
                                    <td width="25%">
                                    </td>
                                    <td width="25%">
                                        <span id="startDate">start</span><br/>
                                        <span id="start">start</span>
                                    </td>
                                    <td width="25%" style="text-align:center">
                                        <span id="currentDate">current</span><br/>
                                        <span id="current">current</span>
                                    </td>
                                    <td width="25%" style="text-align:right">
                                        <span id="endDate">end</span><br/>
                                        <span id="end">end</span>
                                    </td>
                                </tr>
                            </table>
                        </form>
                    </div>

                    <div id="legend" style="display:block; overflow: auto; background-color: white;">
                                                                                
                    </div>

                    <div role="group" aria-label="Animation controls" >
                        <div id="popup" class="ol-popup">
                            <a href="#" id="popup-closer" class="ol-popup-closer"></a>
                            <div id="popup-content"  class="clearfix" style="overflow: auto;"></div>
                        </div>
                    </div>
                </div>
            </div>
            
            <h4>
                <div>
                    <button class="w3-button w3-white" style="padding-left:0px; padding-right:0px; font-size:0.6em;" onclick="collapse_tree(this, '#MenuTree')">&#9650;</button>
                    Layers
                </div>
            </h4>
            <div id="MenuTree" class="MenuSection"></div>

            <h4>
                <div>
                    <button class="w3-button w3-white" style="padding-left:0px; padding-right:0px; font-size:0.6em;" onclick="collapse_tree(this, '#InfoTree')">&#9660;</button>
                    Further information
                </div>
            </h4>
            <div id="InfoTree" class="MenuSection"></div>
        </div>

        <!-- This is the main map container. It is populated in code -->
        <div id="MapContainer">
            <div class="ol-unselectable ol-custom ol-control">
               <button class="ol-zoom-in " onclick="w3_open('MenuContainer')">☰</button>
            </div>            
            <!-- This is the tool-tip container. It is populated in code -->
            <div id="ToolTipInfo"></div>            
            <!-- This is the legend (ScreenOverlay) container. It is populated in code -->
            <div id="LegendInfo">
                <a id="Legend" href="" style="display:none"/>
            </div>            

            <img id="photo" style="top: 9.5em; left: .5em; display:none; "/>
        </div>

        <!-- This is the debug window container that should be hidden in final application. It is populated in code  -->
        <div id="DebugWindow" style="display:none;"></div>
        
        <script>
            var info = $("#ToolTipInfo");
            
            info.tooltip('hide');
            info.tooltip({
                animation: false,
                trigger: 'manual'
            });
            
            function collapse_tree(btn, elem) {
                var collapse = false;
                if($(elem+' li.jstree-open').length)
                {
                    collapse = true;
                }
                if (collapse) {
                    $(elem).jstree(true).close_all();
                    btn.innerText="\u25BC";
                }
                else {
                    $(elem).jstree(true).open_all();
                    btn.innerText="\u25B2";
                }
            }

            function section_toggle(id) {
                if (document.getElementById(id).style.display === "none") {
                    w3_open(id);
                }
                else {
                    w3_close(id);
                }
            }
    
            function w3_open(id) {
                if (id === "MenuContainer") {
                    $("#MenuTree").jstree(true).close_all();
                }
                document.getElementById(id).style.display = "block";
            }
            function w3_close(id) {
                document.getElementById(id).style.display = "none";
            }
           
        </script>

    </body>
</html>

var App4Sea=App4Sea||{},App4SeaAnimation=function(){"use strict";function e(){var e=document.getElementById("start");e.innerHTML=m.substr(m.length-8,8),e=document.getElementById("current"),e.innerHTML=y.substr(y.length-8,8),e=document.getElementById("end"),e.innerHTML=g.substr(g.length-8,8),e=document.getElementById("startDate"),e.innerHTML=m.substr(0,10),e=document.getElementById("currentDate"),e.innerHTML=y.substr(0,10),e=document.getElementById("endDate"),e.innerHTML=g.substr(0,10)}function t(){var e=document.getElementById("current");if("undefined"!==e){e.innerHTML=y.substr(y.length-8,8),e=document.getElementById("currentDate"),e.innerHTML=y.substr(0,10);var t=a.AniData[d][A],o=(n(t),1);App4Sea.TreeMenu.Checkbox(t,!0);for(var r=A-o;r<0;)r+=u;t=a.AniData[d][r],App4Sea.TreeMenu.Checkbox(t,!1),w.value=100*A/u,A+=1,A===u&&(A=0)}}function n(e){for(var t=0;t<App4Sea.OpenLayers.layers.length;t++){var n=App4Sea.OpenLayers.layers[t];if(n.id===e)return t}return-1}function o(){return"Playing"!==f?(l(),void(f="Stopped")):null===h||null===a.AniData[i]?(l(),void(f="Stopped")):(y=0!==a.AniData[p].length?a.AniData[p][A].innerHTML:a.AniData[s][A].innerHTML,void t())}var a={Animate:function(e,t){"Stopped"!==f&&l(),f="Stopped";var n=e.substr(e.length-3,3);if("kml"!==n&&"kmz"!==n)return;u=a.AniData[i].length;let o=document.getElementById("AniDataSelect");for(let e=0;e<o.length;e++)"No data available"==o.options[e].text&&o.remove(e);let r=document.createElement("option");r.innerHTML=t,o.appendChild(r),o.value=t},getAnimationState:function(){return f},MoreSpeed:function(){S<30.01&&(S+=1,null!==h&&(window.clearInterval(h),h=window.setInterval(o,1e3/S)))},LessSpeed:function(){S>1.99&&(S-=1,null!==h&&(window.clearInterval(h),h=window.setInterval(o,1e3/S)))},PlayStop:function(){if("Stopped"!==f&&"Playing"!==f)return;f="Transition";let e=v.classList.contains("fa-play");e?(l(),r(),v.classList.remove("fa-play"),v.classList.add("fa-stop"),h=window.setInterval(o,1e3/S),f="Playing"):(l(),f="Stopped")}},r=function(){if(0!==u){for(var t=0;t<u;t++)App4Sea.TreeMenu.Checkbox(a.AniData[d][t],!1);0!==a.AniData[p].length?(m=a.AniData[p][0].innerHTML,g=a.AniData[p][a.AniData[1].length-1].innerHTML):(m=a.AniData[s][0].innerHTML,g=a.AniData[c][a.AniData[c].length-1].innerHTML),y=m,e()}},l=function(){f="Stopping",null!==h&&(window.clearInterval(h),h=null),v.classList.remove("fa-stop"),v.classList.add("fa-play")};a.Progress=function(){void 0!==u&&(A=parseInt(.5+w.value*u/100),l(),f="Stopped",r(),t())},a.AniData=[[],[],[],[],[]];const i=0,p=1,s=2,c=3,d=4;let u,g,m,y,f="Stopped",S=1,h=null,A=0;const v=document.getElementById("playstop"),w=document.getElementById("progress");return w.addEventListener("input",a.Progress,!1,{passive:!0}),w.addEventListener("touch",a.Progress,!1,{passive:!0}),a}();App4Sea=App4Sea||{},$(document).ready(function(){"use strict";App4Sea.logging&&console.log("Document ready"),App4Sea.OpenLayers.Init(),$(".MenuItem").click(function(){App4Sea.logging&&console.log("MenuItem click");var e=$(this).attr("data-url"),t=$(this).attr("data-target");window.open(e,t)})}),$(window).on("load",function(){"use strict";App4Sea.logging&&console.log("Window load"),setTimeout(function(){App4Sea.logging&&console.log("setTimeout"),$("#splash-overlay").fadeOut()},2e3);var e=$("#ToolTipInfo");e.tooltip("hide"),e.tooltip({animation:!1,trigger:"manual"})}),$(window).on("resize",function(){"use strict";const e=document.getElementById("ControlPlaceInMap");window.innerWidth<500?(e.style.left=0,e.transform=null):(e.style.left=null,e.transform="translate(-50%, 0%)");let t=e.clientWidth/2+.5;e.offsetLeft-t>window.innerWidth-40&&(e.style.left=window.innerWidth-40+t+"px")});App4Sea=App4Sea||{};var App4SeaKML=function(){"use strict";function e(e,o){var a=e.toLowerCase();App4Sea.logging&&console.log(a),a.endsWith("kmz")?(App4Sea.logging&&console.log("readAndAddFeatures kmz element: "+e),t(e,o,n(u,o))):(App4Sea.logging&&console.log("readAndAddFeatures non-kmz element: "+e),t(e,o,u))}function t(e,t,n){App4Sea.logging&&console.log("ajaxKMZ: "+e);let o=function(e,n){return function(o,a){App4Sea.logging&&console.log("ajaxKMZ OK: "+o.responseURL);let r=o.responseURL.toLowerCase(),l=typeof a;if(!r.endsWith("kml")||"object"!==l&&"string"!==l)App4Sea.logging&&console.log("Now handlilng "+r),n(a,r,t);else{let t=function(e,t,n){return function(o){App4Sea.logging&&console.log("Callback: "+t+": "+e);let a=o.srcElement.result;App4Sea.logging&&console.log(a),n(a,e,t)}},o=new FileReader;o.addEventListener("loadend",t(r,e,n),!1,{passive:!0}),"string"===l?n(a,r,e):o.readAsBinaryString(a)}}},a="multipart/form-data";e.toLowerCase().endsWith("kmz")?a="blob":e.toLowerCase().endsWith("kml")&&(a="text"),qwest.get(e,null,{responseType:a,cache:!0,headers:{crossOrigin:"anonymous"}}).then(o(t,n)).catch(function(e,n){App4Sea.logging&&console.log("ajaxKMZ Error: "+e+": Url: "+n.responseURL+", id: "+t)}).complete(function(){})}function n(e,t){return function(n){App4Sea.logging&&console.log("Unzip id "+t),zip.createReader(new zip.BlobReader(n),function(n){n.getEntries(function(n){App4Sea.logging&&console.log("Got entries: "+n.length);for(let o=0;o<n.length;o++){let a=function(e,t,n,o){return function(a){n(a,e,t,o)}},r=n[o].filename.toLowerCase();r.endsWith(".kml")&&(App4Sea.logging&&console.log("Entry "+o+": "+r),n[o].getData(new zip.TextWriter,a(r,t,e,n),function(e,t){}))}})},function(e){App4Sea.logging&&console.log("unzipFromBlob Error: "+e)})}}function o(e,t,n){App4Sea.logging&&console.log(">>> addKMLFeatures: "+t),t.endsWith("kml")&&(a(e,n,t),App4Sea.logging&&console.log("addKMLFeatures: "+n+" in file "+t+" DONE")),App4Sea.logging&&console.log("<<< addKMLFeatures")}function a(e,t,n){App4Sea.logging&&console.log("loadKmlText: "+n);let o=new ol.format.KML({extractStyles:!0,extractAttributes:!0,showPointNames:!1}),a=o.readProjection(e);null!==a&&App4Sea.logging&&console.log("Projection: "+a.wb);let r=o.readFeatures(e,{dataProjection:App4Sea.prefProj,featureProjection:App4Sea.prefViewProj});App4Sea.logging&&console.log("kml_features are: "+r.length),r.length;let l=new ol.layer.Vector({source:new ol.source.Vector({crossOrigin:"anonymous",format:o})});l.getSource().addFeatures(r),App4Sea.OpenLayers.layers.push({id:t,vector:l}),App4Sea.logging&&console.log("Cached layers now are "+App4Sea.OpenLayers.layers.length),App4Sea.OpenLayers.Map.addLayer(l),App4Sea.Utils.LookAt(l)}function r(e,t,n){return{type:n.nodeName,id:n.id,newId:e,parentId:t,node:n,value:n.innerHTML}}function l(e,t){var n,o=e+"-"+t.id;switch(t.nodeName){case"StyleMap":n=r(o,e,t),App4Sea.OpenLayers.styleMaps.push(n);break;case"Style":n=r(o,e,t),App4Sea.OpenLayers.styleMaps.push(n),o=App4Sea.OpenLayers.styleMaps.length}return o}function i(e,t,n,o,a,r){let l=a;App4Sea.disableSubItems||(l=!1);let i={state:{closed:!0,checkbox_disabled:!1,disabled:l},icon:r,text:e,data:t,selected:!0,children:!1},p=n.jstree(!0).create_node(o,i,"last",!1,!1);return p}function p(e,t,n,o){function a(e,t){for(var n=0;n<e.length;n++)if("name"===e[n].nodeName||"atom:name"===e[n].nodeName)return e[n].innerHTML;return t}function r(e,t){var n=document.createElement("tr");n.name=e,n.innerHTML='<td><img class="imgLegend" src="'+t+'" alt="Legend"/></td>                <td><button class="btn-right" title="Close" onclick="App4Sea.KML.removeRow(this)"><i class="fa fa-close"></i></button></td>';const o=document.getElementById("tableLegend");o.appendChild(n)}function p(e,t){function n(e,t,n,o,a,l){let i=function(e,t,n,o,a,l){return function(e){let o=URL.createObjectURL(e);if(l)r(s,o);else{let e=new ol.source.ImageStatic({url:o,imageExtent:t}),r=new ol.layer.Image({name:n,source:e});r?(App4Sea.OpenLayers.layers.push({id:a,vector:r}),App4Sea.OpenLayers.Map.addLayer(r)):App4Sea.logging&&console.log("No image created from kmz")}}};e.getData(new zip.BlobWriter("text/plain"),i(t,n,o,e,a,l))}function a(e,t,o,a,r,l){let i=!1;for(let p=0;p<e.length;p++)e[p].filename===t&&(n(e[p],t,o,a,r,l),i=!0);i||App4Sea.logging&&console.log("Didn't find file in kmz: "+t)}let l,i=e.querySelector("Icon href"),p="";const s=e.querySelector("name");if(s&&(p=s.innerHTML),i&&(l=i.innerHTML),"ScreenOverlay"===e.nodeName)App4Sea.logging&&console.log("ScreenOverlay: "+l),l&&(!l.startsWith("http")&&o&&o.length>1?a(o,l,null,p,t,!0):r(s,l));else{if("PhotoOverlay"===e.nodeName)return void(App4Sea.logging&&console.log("PhotoOverlay: "+l));{App4Sea.logging&&console.log("GroundOverlay: "+l),l=l.replaceAll(/&amp;/,"&");const n=parseFloat(e.querySelector("west").innerHTML),r=parseFloat(e.querySelector("south").innerHTML),i=parseFloat(e.querySelector("east").innerHTML),s=parseFloat(e.querySelector("north").innerHTML);let d,u=ol.proj.transformExtent([n,r,i,s],App4Sea.prefProj,App4Sea.prefViewProj);if(c+=1,!l.startsWith("http")&&o&&o.length>1)a(o,l,u,p,t);else{let e=new ol.source.ImageStatic({url:l,crossOrigin:"anonymous",imageExtent:u});d=new ol.layer.Image({name:p,source:e}),d&&(App4Sea.OpenLayers.layers.push({id:t,vector:d}),App4Sea.OpenLayers.Map.addLayer(d))}}}}function u(e,t){for(var n=0;n<t.length;n++){var o,r=t[n];if("name"===r.nodeName||"atom:name"===r.nodeName)App4Sea.logging&&console.log("Name item not handled: "+r.innerHTML);else if("description"===r.nodeName){let t=r;if(""!==t.innerHTML){let n=App4Sea.Utils.NoXML(t.innerHTML);o=i("Description",n,$("#TreeMenu"),e,!1,"icons/description.png")}}else if("author"===r.nodeName||"atom:author"===r.nodeName){let t=r,n="<p>";for(let e=0;e<t.children.length;e++){0!==e&&(n+="<br/>");let o=App4Sea.Utils.NoXML(t.children[e].innerHTML);n+=o}n+="</p>",o=i("Author",n,$("#TreeMenu"),e,!1,"icons/author.png")}else if("Folder"===r.nodeName||"Document"===r.nodeName)o=i(a(r.children,r.nodeName),r.innerHTML,$("#TreeMenu"),e,!0,"icons/folder.png");else if("Camera"===r.nodeName){let e;e=r.getElementsByTagName("longitude");let t=parseFloat(e[0].textContent);e=r.getElementsByTagName("latitude");let n=parseFloat(e[0].textContent);e=r.getElementsByTagName("altitude");let o=parseFloat(e[0].textContent),a=ol.proj.transform([t,n],App4Sea.prefProj,App4Sea.prefViewProj),l=App4Sea.Utils.altitudeToZoom(o),i=App4Sea.OpenLayers.Map.getView();i.setCenter(a),i.setZoom(l),App4Sea.logging&&console.log("Camera set to lon="+t+" lat="+n+" alt="+o+"m zoom="+l)}else if("Placemark"===r.nodeName)o=i(a(r.children,r.nodeName),r.innerHTML,$("#TreeMenu"),e,!0,"icons/placemark.png");else if("GroundOverlay"===r.nodeName||"PhotoOverlay"===r.nodeName||"ScreenOverlay"===r.nodeName){o=i(a(r.children,r.nodeName),r.innerHTML,$("#TreeMenu"),e,!1,"icons/overlay.png"),p(r,o);for(var s="",c=0;c<r.children.length;c++){var d=r.children[c].localName;if(d=d.substr(0,4),"Icon"===d&&r.children[c].children&&r.children[c].children.length>0){s=r.children[c].children[0].innerHTML;break}}"GroundOverlay"===r.nodeName&&s===h[M].innerHTML&&(L[M]=o,M+=1)}else"StyleMap"===r.nodeName||"Style"===r.nodeName?o=l(e,r):"TimeSpan"===r.nodeName||"TimeStamp"===r.nodeName||"Link"===r.nodeName||"atom:link"===r.nodeName||"NetworkLink"===r.nodeName||"open"===r.nodeName||"href"===r.nodeName||"visibility"===r.nodeName||"refreshMode"===r.nodeName||"refreshInterval"===r.nodeName||"ExtendedData"===r.nodeName||"Icon"===r.nodeName||"LatLonBox"===r.nodeName||"MultiGeometry"===r.nodeName||"gx:Tour"===r.nodeName||"gx:Playlist"===r.nodeName||"Schema"===r.nodeName||"SimpleField"===r.nodeName||"LineString"===r.nodeName||"Point"===r.nodeName||"Snippet"===r.nodeName||"Region"===r.nodeName||"longitude"===r.nodeName||"latitude"===r.nodeName||"altitude"===r.nodeName||"tilt"===r.nodeName||"altitudeMode"===r.nodeName||"roll"===r.nodeName||"gx:altitudeMode"===r.nodeName||"key"===r.nodeName||"styleUrl"===r.nodeName||"Pair"===r.nodeName||"BalloonStyle"===r.nodeName||"text"===r.nodeName||"LabelStyle"===r.nodeName||"PolyStyle"===r.nodeName||"LineStyle"===r.nodeName||"ListStyle"===r.nodeName||"gx:IconStackStyle"===r.nodeName||"IconStyle"===r.nodeName||""!==r.innerHTML&&App4Sea.logging&&console.log("Not handling "+r.nodeName+" with "+r.innerHTML);if(r.children&&r.children.length>0){for(var g=[],m=r.parentNode;m;)g.push(m),m=m.parentNode;g&&g.length<4&&u(o,r.children)}}}App4Sea.logging&&console.log("parseKmlText: "+e);var g=new DOMParser,m=g.parseFromString(t,"text/xml"),y=m.querySelectorAll("NetworkLink > Link > href"),f=m.querySelectorAll("NetworkLink > Url > href"),S=!1,h=m.querySelectorAll("GroundOverlay > Icon > href"),A=[],v=[],w=[],L=[],M=0;h.length>1?(S=!0,A=m.querySelectorAll("GroundOverlay > TimeStamp > when"),0===A.length?(v=m.querySelectorAll("GroundOverlay > TimeSpan > begin"),w=m.querySelectorAll("GroundOverlay > TimeSpan > end"),A=[]):(v=[],w=[]),App4Sea.Animation.AniData=[h,A,v,w,L]):App4Sea.Animation.AniData=[null,null,null,null,null];var b=m.querySelector("kml");s.removeRow=function(e){document.getElementById("tableLegend").removeChild(e.parentNode.parentNode)},b&&(u(n,b.children),S&&App4Sea.Animation.Animate(e,d));var I=Array.prototype.slice.call(y).map(function(e){return e.textContent});return 0===y.length&&0!==f.length&&(I=Array.prototype.slice.call(f).map(function(e){return e.textContent})),App4Sea.logging&&console.log("NetworkLink files: "+I.length),I}var s={};let c=0;var d="";zip.workerScriptsPath="static/js/",s.loadKml=function(e){App4Sea.logging&&console.log("loadKml: "+e);var t=new ol.layer.Vector({source:new ol.source.Vector({url:e,crossOrigin:"anonymous",format:new ol.format.KML({extractStyles:!0,extractAttributes:!0,showPointNames:!1})})});return t},s.loadKmlKmz=function(t,n,o){App4Sea.logging&&console.log("loadKmz: "+n+" from "+t),d=o,e(t,n)};let u=function(t,n,a,r){App4Sea.logging&&console.log("readAndAddFeatures >>>> "+n+" from file "+a);let l=n.toLowerCase();if(l.endsWith("kml")){o(t,l,a);let i=p(n,t,a,r);App4Sea.logging&&console.log("listFilesNested are "+i.length),i.forEach(function(t){App4Sea.logging&&console.log("readAndAddFeatures ----------"),e(t,a)})}App4Sea.logging&&console.log("readAndAddFeatures <<<<")};return s}(),App4SeaMeasure=(App4Sea=App4Sea||{},function(){"use strict";function e(e){let o;S=e,a=new ol.interaction.Draw({source:r,type:S,style:new ol.style.Style({fill:new ol.style.Fill({color:"rgba(255, 55, 55, 0.2)"}),stroke:new ol.style.Stroke({color:"rgba(0, 0, 0, 0.5)",lineDash:[10,10],width:2}),image:new ol.style.Circle({radius:5,stroke:new ol.style.Stroke({color:"rgba(0, 0, 0, 0.7)"}),fill:new ol.style.Fill({color:"rgba(255, 55, 55, 0.2)"})})})}),App4Sea.OpenLayers.Map.addInteraction(a),n(),t(),a.on("drawstart",function(e){i=e.feature;let t=e.coordinate;o=i.getGeometry().on("change",function(e){let n,o=e.target;o instanceof ol.geom.Polygon?(n=v(o),t=o.getInteriorPoint().getCoordinates()):o instanceof ol.geom.LineString&&(n=A(o),t=o.getLastCoordinate()),c.innerHTML=n,d.setPosition(t)})},this),a.on("drawend",function(){c.className="tooltip tooltip-static",d.setOffset([0,-7]),i=null,c=null,n(),ol.Observable.unByKey(o)},this)}function t(){p&&p.parentNode&&p.parentNode.removeChild(p),p=document.createElement("div"),p.className="tooltip hidden",s=new ol.Overlay({element:p,offset:[15,0],positioning:"center-left"}),App4Sea.OpenLayers.Map.addOverlay(s)}function n(){c&&c.parentNode&&c.parentNode.removeChild(c),c=document.createElement("div"),c.className="tooltip tooltip-measure",d=new ol.Overlay({element:c,offset:[0,-30],positioning:"bottom-center"}),App4Sea.OpenLayers.Map.addOverlay(d)}function o(e){let t=document.getElementsByClassName(e);if(t)for(;t.length;)t[0]&&t[0].parentNode&&t[0].parentNode.removeChild(t[0])}let a,r,l,i,p,s,c,d,u={},g=[];const m="Click to continue drawing\nthe polygon to measure area",y="Click to continue drawing\nthe line to measure length";let f,S="NotActive",h=function(e){if("NotActive"===S||e.dragging)return;let t="Click to start measuring";if(i){let e=i.getGeometry();e instanceof ol.geom.Polygon?t=m:e instanceof ol.geom.LineString&&(t=y)}p.innerHTML=t,s.setPosition(e.coordinate),p.classList.remove("hidden")},A=function(e){let t,n=ol.sphere.getLength(e);return t=n>100?Math.round(n/1e3*100)/100+" km":Math.round(100*n)/100+" m",t},v=function(e){let t,n=ol.sphere.getArea(e);return t=n>1e4?Math.round(n/1e6*100)/100+" km<sup>2</sup>":Math.round(100*n)/100+" m<sup>2</sup>",t};u.DoLength=function(){b(),M("LineString");const e=document.getElementById("btnArea"),t=document.getElementById("btnLength");e.style.borderStyle="none",t.style.borderStyle="inset"},u.DoArea=function(){b(),M("Polygon");const e=document.getElementById("btnArea"),t=document.getElementById("btnLength");e.style.borderStyle="inset",t.style.borderStyle="none"},u.DoClearAll=function(){b(),p&&p.parentNode&&p.parentNode.removeChild(p),c&&c.parentNode&&c.parentNode.removeChild(c),g.forEach(e=>{App4Sea.OpenLayers.Map.removeLayer(e)}),g=[],o("tooltip tooltip-measure"),o("tooltip tooltip-static"),w();const e=document.getElementById("btnArea"),t=document.getElementById("btnLength");e.style.borderStyle="none",t.style.borderStyle="none"},u.DoAcceptDragAndDrop=function(){f=new ol.interaction.DragAndDrop({formatConstructors:[ol.format.GPX,ol.format.GeoJSON,ol.format.IGC,ol.format.KML,ol.format.TopoJSON]}),f.on("addfeatures",function(e){let t=new ol.source.Vector({features:e.features}),n=new ol.layer.Vector({source:t});g.push(n),App4Sea.OpenLayers.Map.addLayer(n),App4Sea.Utils.LookAt(t)}),App4Sea.OpenLayers.Map.addInteraction(f)},u.DoSaveAll=function(){if(!r)return;let e=r.getFeatures(),t="App4Sea_"+Date.now().toString()+".kml",n=App4Sea.Utils.GetKMLFromFeatures(e,t);App4Sea.Utils.DoSaveKML(n,t)},u.DoNothing=function(e){u.DoClearAll(),App4Sea.Utils.w3_close(e)};let w=function(){App4Sea.OpenLayers.Map.removeLayer(l),l=null,r=null},L=function(){App4Sea.OpenLayers.Map.removeLayer(l),r=new ol.source.Vector,l=new ol.layer.Vector({source:r,style:new ol.style.Style({fill:new ol.style.Fill({color:"rgba(255, 55, 55, 0.2)"}),stroke:new ol.style.Stroke({color:"#ffcc33",width:2}),image:new ol.style.Circle({radius:7,fill:new ol.style.Fill({color:"#ffcc33"})})})}),App4Sea.OpenLayers.Map.addLayer(l)},M=function(t){l||L(),e(t),App4Sea.OpenLayers.Map.on("pointermove",h),App4Sea.OpenLayers.Map.getViewport().addEventListener("mouseout",function(){p.classList.add("hidden")},!1,{passive:!0})},b=function(){S="NotActive",App4Sea.OpenLayers.Map.removeInteraction(a)};return u.GetType=function(){return S},u.DropMarker=function(){let e=new ol.Feature({geometry:new ol.geom.Point(ol.proj.fromLonLat([0,50]))}),t=new ol.source.Vector({features:[e]}),n=new ol.layer.Vector({source:t});App4Sea.OpenLayers.Map.addLayer(n)},u}()),App4SeaOpenLayers=(App4Sea=App4Sea||{},function(){"use strict";function e(){u.descriptionContainer=document.getElementById("InfoPopup"),p=new ol.layer.Tile({name:"osmTileLayer",crossOriginKeyword:"anonymous",source:new ol.source.OSM}),s=new ol.layer.Tile({name:"esriWSPTileLayer",crossOriginKeyword:"anonymous",source:new ol.source.XYZ({attributions:['&copy; <a href="https://services.arcgisonline.com/ArcGIS/rest/services/World_Street_Map/MapServer/0">ArcGIS World Street Map</a>'],url:"https://services.arcgisonline.com/ArcGIS/rest/services/World_Street_Map/MapServer/tile/{z}/{y}/{x}"})}),c=new ol.layer.Tile({name:"esriWITileLayer",crossOriginKeyword:"anonymous",source:new ol.source.XYZ({attributions:['&copy; <a href="https://services.arcgisonline.com/arcgis/rest/services/World_Imagery/MapServer/0">ArcGIS World Imagery Map</a>'],url:"https://services.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}"})}),d=new ol.layer.Tile({name:"blackTileLayer",crossOriginKeyword:"anonymous",source:new ol.source.XYZ({attributions:['&copy; <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a> &copy; <a href="http://cartodb.com/attributions">CartoDB</a>'],url:"http://{a-c}.basemaps.cartocdn.com/dark_all/{z}/{x}/{y}.png"})})}function t(){let e=new ol.Map({target:"MapContainer",view:new ol.View({center:App4Sea.mapCenter,zoom:App4Sea.startZoom,minZoom:App4Sea.minZoom,maxZoom:App4Sea.maxZoom})});u.Map=e,u.Map.on("singleclick",function(e){App4Sea.PopUps.SingleClick(e)}),u.Map.on("not_working",function(e){App4Sea.Weather.NotWorking(e)})}function n(){let e=$("#MenuLayer_Select").val();if(e!==i.name){u.Map.removeLayer(i);let t=$("#MenuContainer"),n=$("#ButtonsForMenu"),o=$("#ButtonsForTools"),a=$("#ButtonsForSettings"),r=$("#ButtonsForToolsInMap"),l=document.getElementsByClassName("ol-mouse-position");"osmTileLayer"===e?(t[0].style.backgroundImage="var(--gradientWhite)",t[0].style.color="black",n[0].style.filter="invert(0%)",o[0].style.filter="invert(0%)",a[0].style.filter="invert(0%)",r[0].style.filter="invert(0%)",l&&l.length>0&&(l[0].style.color="black"),i=p):"esriWSPTileLayer"===e?(t[0].style.backgroundImage="var(--gradientBeige)",t[0].style.color="black",n[0].style.filter="invert(0%)",o[0].style.filter="invert(0%)",a[0].style.filter="invert(0%)",r[0].style.filter="invert(0%)",l&&l.length>0&&(l[0].style.color="black"),i=s):"esriWITileLayer"===e?(t[0].style.backgroundImage="var(--gradientBlue)",t[0].style.color="beige",n[0].style.filter="invert(100%)",o[0].style.filter="invert(100%)",a[0].style.filter="invert(100%)",r[0].style.filter="invert(100%)",l&&l.length>0&&(l[0].style.color="beige"),i=c):"blackTileLayer"===e&&(t[0].style.backgroundImage="var(--gradientGray)",t[0].style.color="gray",n[0].style.filter="invert(100%)",o[0].style.filter="invert(100%)",a[0].style.filter="invert(100%)",r[0].style.filter="invert(100%)",l&&l.length>0&&(l[0].style.color="gray"),i=d),u.Map.addLayer(i)}}function o(){u.Map.addControl(new ol.control.FullScreen),u.Map.addControl(new ol.control.Rotate({autoHide:!0}));var e=new ol.control.MousePosition({projection:App4Sea.prefProj,coordinateFormat:function(e){var t=ol.coordinate.toStringHDMS(e);return t}});u.Map.addControl(e),u.Map.addControl(new ol.control.OverviewMap({layers:[i],collapsed:!0}))}function a(){App4Sea.TreeMenu.SetUp(),App4Sea.TreeInfo.SetUp(),$("#MenuContainer input[type='checkbox']").click(function(){n()}),$("#MenuContainer select").change(function(){n()})}function r(){const e=document.getElementById("popup"),t=document.getElementById("popup-closer");App4Sea.PopUps.overlayLayerPopUp=l(e,t),u.Map.addOverlay(App4Sea.PopUps.overlayLayerPopUp),App4Sea.PopUps.initToolTip()}function l(e,t){var n=new ol.Overlay({element:e,autoPan:!0,autoPanAnimation:{duration:2e3}});return t&&(t.onclick=function(){return n.setPosition(void 0),t.blur(),!1}),n}let i,p,s,c,d,u={};return u.Map,u.styleMaps=[],u.layers=[],u.descriptionContainer,u.Init=function(){e(),t(),i=s,n(),o(),a(),r()},u.MapChange=function(){let e=$("#MenuLayer_Select2"),t=$("#MenuLayer_Select");t[0].selectedIndex=e[0].selectedIndex,n()},u}()),App4SeaPopUps=(App4Sea=App4Sea||{},function(){"use strict";function e(e){let t={name:"",description:"",address:"",linkinfo:"",linkicon:"",linkimage:"",linkvideo:""};t.name=e[0].get("name"),t.description=e[0].get("description"),t.address=e[0].get("address"),t.linkinfo=e[0].get("linkinfo"),t.linkicon=e[0].get("linkicon"),t.linkimage=e[0].get("linkimage"),t.linkvideo=e[0].get("linkvideo");const n='<div style="margin:2px;">\n            <p><b>Description: </b>{{description}}</p>\n            <p><b>Address: </b>{{address}}</p>\n            <p><b>Information: </b>{{linkinfo}}</p>\n            <p><b>Icon: </b>{{linkicon}}</p>\n            <p><b>Image: </b>{{linkimage}}</p>\n            <p><b>Video: </b>{{{linkvideo}}}</p>\n        </div>';Mustache.parse(n);let o=Mustache.to_html(n,t);return o}function t(e){let t={name:"",region:"",region2:"",region3:"",region4:"",address:"",link:""};t.name=e[0].get("navn"),t.address=e[0].get("gateadresse"),t.region=e[0].get("fylke"),t.region2=e[0].get("kyv_region"),t.region3=e[0].get("kommune"),t.region4=e[0].get("lua"),t.link=e[0].get("lenke_faktaark");const n='<div style="margin:2px;">\n                <p>{{address}}</p>\n                <p>{{region}}</p>\n                <p>{{region2}}</p>\n                <p>{{region3}}</p>\n                <p>{{region4}}</p>\n                <p>{{{link}}}</p>\n            </div>';Mustache.parse(n);let o=Mustache.to_html(n,t);return o}function n(e){let t={name:"",callsign:"",type:"",cargotype:"",flag:""};t.name=e[0].get("Name"),t.callsign=e[0].get("Call_Sign"),t.type=e[0].get("Type"),t.cargotype=e[0].get("Cargo_Type"),t.flag=e[0].get("Flag");const n='<div style="margin:2px;">\n                <p>{{callsign}}</p>\n                <p>{{type}}</p>\n                <p>{{cargotype}}</p>\n                <p>{{flag}}</p>\n            </div>';Mustache.parse(n);let o=Mustache.to_html(n,t);return o}function o(e){let t;if("styleUrl"===e.nodeName)for(var n=App4Sea.OpenLayers.styleMaps.length-1;n>=0;n--){var a=App4Sea.Utils.parseURL(e.innerHTML);if("#"+App4Sea.OpenLayers.styleMaps[n].id===a.hash&&(t=o(App4Sea.OpenLayers.styleMaps[n].node),t))return t}if("BalloonStyle"===e.nodeName&&e.children.length>0)return t=e.children[0].innerHTML,t;for(let n=0;n<e.children.length;n++){let a=e.children[n];if(t=o(a),t)return t}return t}function a(e){let t=e.get("name");return t||(t=e.get("navn")),t}let r={};r.overlayLayerPopUp;const l=document.getElementById("popup-content"),i=document.getElementById("popup-closer"),p=document.getElementById("popup-title");return r.SingleClick=function(s){if("NotActive"!==App4Sea.Measure.GetType())return;let c=s.coordinate,d=[];if(App4Sea.OpenLayers.Map.forEachFeatureAtPixel(s.pixel,function(e){d.push(e)}),d.length>0){let i=d[0].get("description");d[0].get("SiteID")?i=e(d):d[0].get("navn")?i=t(d):d[0].get("Id")&&(i=n(d)),i||(i=d[0].get("name"));let s,u=d[0].get("styleUrl");for(let e=App4Sea.OpenLayers.styleMaps.length-1;e>=0;e--){let t=App4Sea.Utils.parseURL(u);if("#"+App4Sea.OpenLayers.styleMaps[e].id===t.hash&&(s=o(App4Sea.OpenLayers.styleMaps[e].node),s))break}if("$[description]"===s&&(s=i),s){let e=App4Sea.Utils.NoXML(s),t=e,n=t.replaceAll(/\$\[(.+?)\//,"{{");n=n.replaceAll("]","}}"),n=n.replaceAll("{{http","{{{http"),n=n.replaceAll(/{{{(.+?)}}/,/{{{(.+?)}}}/),i=App4Sea.PopUps.PopulateTemplate(n,d[0])}let g=a(d[0]);p.innerHTML=g||"",i&&(l.innerHTML=i,r.overlayLayerPopUp.setPosition(c))}else r.overlayLayerPopUp.setPosition(void 0),i.blur()},r.initToolTip=function(){let e=App4Sea.OpenLayers.Map,t=function(t){$("#ToolTipInfo").css({left:t[0]+"px",top:t[1]-15+"px"});let n=e.forEachFeatureAtPixel(t,function(e,t){return e});if(n){let e=a(n);if(e){let t=$("#ToolTipInfo");t.tooltip("hide").attr("data-original-title",e).tooltip("show")}else $("#ToolTipInfo").tooltip("hide")}else $("#ToolTipInfo").tooltip("hide")};e.on("pointermove",function(n){n.dragging?$("#ToolTipInfo").tooltip("hide"):t(e.getEventPixel(n.originalEvent))}),$(e.getViewport()).on("mousemove",function(n){t(e.getEventPixel(n.originalEvent))})},r.PopulateTemplate=function(e,t){Mustache.parse(e);let n=Mustache.to_html(e,t.values_);return n},r}()),App4SeaTreeInfo=(App4Sea=App4Sea||{},function(){"use strict";let e={},t=0,n=[];return e.SetUp=function(){function e(e){let t;return t="#"===e.id?"json/info.json":"json/"+e.id+".json",t}function o(e){$("#TreeInfo").jstree({core:{check_callback:!1,themes:{dots:!1,icons:!1},error:function(e){App4Sea.logging&&console.log("Error: "+e.error),App4Sea.logging&&console.log("Id: "+e.id),App4Sea.logging&&console.log("Plugin: "+e.plugin),App4Sea.logging&&console.log("Reason: "+e.reason),App4Sea.logging&&console.log("Data: "+e.data)},data:e},plugins:[]})}function a(e,n,o,r){function l(e,n,o,r){return function(e,l,i){for(var p=0;p<e.length;p++){let t=e[p],l=t.children;t.children=!1,r.push(t),l&&a(t,n,o,r)}t--,0===t&&n(r)}}function i(e,n,o){return function(a,r,l){App4Sea.logging&&console.log(a),App4Sea.logging&&console.log(r),App4Sea.logging&&console.log(l),App4Sea.logging&&console.log(e),t--,0===t&&(App4Sea.logging&&console.log("WE ARE DONE WITH ERROR! "+n),n(o))}}let p=o(e);t++,jQuery.ajax({url:p,contentType:"application/json; charset=utf-8",type:"GET",dataType:"JSON",cache:!1,async:!0,success:l(e,n,o,r),error:i(e,n,r)})}a({id:"#"},o,e,n),$("#TreeInfo").on("changed.jstree",function(e,t){App4Sea.logging&&console.log("On: "+t.selected),void 0!==t.node&&""!==t.node.a_attr.path&&window.open(t.node.a_attr.path)})},e}()),App4SeaTreeMenu=(App4Sea=App4Sea||{},function(){"use strict";function e(e,t,n){let o=App4Sea.OpenLayers.descriptionContainer,a=App4Sea.Utils.NoXML(n);o.innerHTML=a;let r=ol.proj.fromLonLat([0,55]),l=new ol.Overlay({position:r,positioning:"center-center",element:o,stopEvent:!1});App4Sea.OpenLayers.Map.addOverlay(l)}function t(){var e=App4Sea.OpenLayers.descriptionContainer;e.innerHTML=""}let n={},o=0,a=[];return n.SetUp=function(){function n(e,t){let n;return n="#"===e.id?"json/"+t:"json/"+e.id+".json",n}function r(e){$("#TreeMenu").jstree({checkbox:{keep_selected_style:!1,real_checkboxes:!0},plugins:["checkbox","context"],core:{check_callback:function(e,t,n,o,a){return"create_node"===e},themes:{dots:!1,icons:App4Sea.useIconsInMenu},error:function(e){App4Sea.logging&&console.log("Error: "+e.error),App4Sea.logging&&console.log("Id: "+e.id),App4Sea.logging&&console.log("Plugin: "+e.plugin),App4Sea.logging&&console.log("Reason: "+e.reason),App4Sea.logging&&console.log("Data: "+e.data)},data:e}})}function l(e,t,n,a,r){function i(e,t,n,a,r){return function(e,i,p){for(var s=0;s<e.length;s++){let o=e[s],i=o.children;o.children=!1,r.push(o),i&&l(o,t,n,a,r)}o--,0===o&&t(r)}}function p(e,t,n){return function(a,r,l){App4Sea.logging&&console.log(a),App4Sea.logging&&console.log(r),App4Sea.logging&&console.log(l),App4Sea.logging&&console.log(e),o--,0===o&&(App4Sea.logging&&console.log("WE ARE DONE WITH ERROR! "+t),t(n))}}let s=n(e,a);o++,jQuery.ajax({url:s,contentType:"application/json; charset=utf-8",type:"GET",dataType:"JSON",cache:!1,async:!0,success:i(e,t,n,a,r),error:p(e,t,r)})}l({id:"#"},r,n,"a4s.json",a),$("#TreeMenu").on("changed.jstree",function(n,o){if(void 0!==o.node){var a=$(this).jstree("get_node",o.node.id);t();for(var r=0;r<App4Sea.OpenLayers.layers.length;r++){for(var l=App4Sea.OpenLayers.Map.getLayers(),i=App4Sea.OpenLayers.layers[r].vector.ol_uid,p=App4Sea.Utils.alreadyActive(i,l),s=!1,c=0;c<o.selected.length;c++)if(o.selected[c]===App4Sea.OpenLayers.layers[r].id){s=!0;break}s||-1===p||App4Sea.OpenLayers.Map.removeLayer(App4Sea.OpenLayers.layers[r].vector)}"Description"===a.text||"Author"===a.text?a.state.selected&&e(a.text,a.id,a.data):a.text;for(var d=0;d<o.selected.length;d++){var u=$(this).jstree("get_node",o.selected[d]),g=App4Sea.Utils.alreadyLayer(u.id,App4Sea.OpenLayers.layers);if(-1!==g){l=App4Sea.OpenLayers.Map.getLayers(),i=App4Sea.OpenLayers.layers[g].vector.ol_uid,p=App4Sea.Utils.alreadyActive(i,l);-1===p&&(App4Sea.OpenLayers.Map.addLayer(App4Sea.OpenLayers.layers[g].vector),App4Sea.Utils.LookAt(App4Sea.OpenLayers.layers[g].vector));continue}let e=u.a_attr.path,t=u.a_attr.tool;u.a_attr.projection;if("animation"===t?App4Sea.Utils.w3_open("AnimationContainer"):"heat"===t&&App4Sea.Utils.w3_open("HeatContainer"),e&&""!==e)if("heat"===t){if(-1===g){var m=App4Sea.Utils.heatMap(e,u.id,u.text);App4Sea.OpenLayers.layers.push({id:u.id,vector:m}),App4Sea.logging&&console.log("Cached layers now are "+App4Sea.OpenLayers.layers.length),App4Sea.OpenLayers.Map.addLayer(m),App4Sea.Utils.LookAt(m)}}else if(e.length>3){var y=e.substr(e.length-3,3);if("1cd"===y){if(-1===g){m=App4Sea.Weather.loadWeather(e,u.id);App4Sea.OpenLayers.layers.push({id:u.id,vector:m}),App4Sea.logging&&console.log("Cached layers now are "+App4Sea.OpenLayers.layers.length),App4Sea.OpenLayers.Map.addLayer(m),App4Sea.Utils.LookAt(m)}}else if("6e4"===y){if(-1===g)m=App4Sea.Weather.loadCityWeather(e,u.id)}else if("wms"===y){if(-1===g){let t=App4Sea.Utils.parseURL(e),n=t.searchObject.bbox.split(","),o=[parseFloat(n[0]),parseFloat(n[1]),parseFloat(n[2]),parseFloat(n[3])],a=parseFloat(t.searchObject.height),r=parseFloat(t.searchObject.width),l=ol.proj.transformExtent(o,App4Sea.prefProj,App4Sea.prefViewProj),i=App4Sea.Utils.loadImage(u,l,!0,e,u.id,u.text,"",r,a,u.a_attr.start);App4Sea.OpenLayers.layers.push({id:u.id,vector:i}),
App4Sea.logging&&console.log("Cached layers now are "+App4Sea.OpenLayers.layers.length),App4Sea.OpenLayers.Map.addLayer(i),App4Sea.Utils.LookAt(i)}}else if("gif"===y||"cgi"===y||"png"===y||"jpg"===y){if(-1===g){let t=[-145.15104058007,21.731919794922,-57.154894212888,58.961058642578],n=ol.proj.transformExtent(t,App4Sea.prefProj,App4Sea.prefViewProj),o=App4Sea.Utils.loadImage(u,n,!0,e,u.id,u.text,"",u.a_attr.width,u.a_attr.height,u.a_attr.start);App4Sea.OpenLayers.layers.push({id:u.id,vector:o}),App4Sea.logging&&console.log("Cached layers now are "+App4Sea.OpenLayers.layers.length),App4Sea.OpenLayers.Map.addLayer(o),App4Sea.Utils.LookAt(o)}}else-1===g&&(App4Sea.KML=App4SeaKML,App4Sea.KML.loadKmlKmz(e,u.id,u.text))}}}})},n.Checkbox=function(e,t){t?$.jstree.reference("#TreeMenu").check_node(e):$.jstree.reference("#TreeMenu").uncheck_node(e)},n}()),App4SeaUtils=(App4Sea=App4Sea||{},function(){"use strict";let e={};const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";e.GetKMLFromFeatures=function(e,t){let n=new ol.format.KML({maxDepth:10,writeStyles:!0,internalProjection:App4Sea.prefViewProj,externalProjection:App4Sea.prefProj}),o="<?xml version='1.0' encoding='utf-8'?>",a=n.writeFeatures(e,{featureProjection:App4Sea.prefViewProj,externalProjection:App4Sea.prefProj}),r=a.match(/<coordinates>(.|\n)*?<\/coordinates>/g);if(r){let e=!1;for(let t=0;t<r.length;t++){let n=r[t].match(/[\ \,]/g);n&&" "===n[1]&&(e=!0)}if(e){let e=a.match(/<coordinates>(.|\n)*? /g);for(;e&&e.length>0;)a=a.replace(e[0],e[0].substr(0,e[0].length-1)+"Ðð"),e=a.match(/<coordinates>(.|\n)*? /g);a=a.replaceAll("Ðð",",0 ")}}let l="";return o+a+l},e.DoSaveKML=function(e,t){let n=document.createElement("a");if(n.setAttribute("href","data:text/plain;charset=utf-8,"+encodeURIComponent(e)),n.setAttribute("download",t),document.createEvent){let e=document.createEvent("MouseEvents");e.initEvent("click",!0,!0),n.dispatchEvent(e)}else n.click()},e.altitudeToZoom=function(e){const t=40487.57,n=7096758e-11,o=91610.74,a=-40467.74;return a+(t-a)/(1+Math.pow(e/o,n))},e.GoHome=function(){let e=App4Sea.OpenLayers.Map.getView();e.setZoom(App4Sea.startZoom),e.setCenter(App4Sea.mapCenter)},e.GetFeaturesExtension=function(e){if(!e||0===e.length)return;let t=ol.extent.createEmpty();for(let n=0;n<e.length;n++)ol.extent.extend(t,e[n].getGeometry().getExtent());return App4Sea.logging&&console.log("Extent is: "+t[0]+", "+t[1]+", "+t[2]+", "+t[3]),t},e.LookAt=function(e){let t=ol.extent.createEmpty(),n=App4Sea.OpenLayers.Map.getSize();if(e.getSource){let n=e.getSource();n.getExtent&&(t=n.getExtent(),App4Sea.logging&&console.log("source.getExtent"))}else t=e.getExtent(),App4Sea.logging&&console.log("vector.getExtent");if(t&&t[0]!==Number.POSITIVE_INFINITY||(t=App4Sea.OpenLayers.Map.getView().calculateExtent(n),App4Sea.logging&&console.log("view.calculateExtent")),t&&t[0]!==Number.POSITIVE_INFINITY&&t[1]){App4Sea.logging&&console.log("Look at: "+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+". Size is: "+n);let e=App4Sea.OpenLayers.Map.getView();e.fit(t,{duration:1e3})}},e.toggleFullscreen=function(){document.fullscreenEnabled?App4Sea.logging&&console.log("Fullscreen is possible in browser"):App4Sea.logging&&console.log("Fullscreen is not possible in browser"),document.fullscreenElement?e.closeFullscreen():e.openFullscreen()},e.openFullscreen=function(){let e=document.documentElement;e.requestFullscreen?e.requestFullscreen():e.mozRequestFullScreen?e.mozRequestFullScreen():e.webkitRequestFullscreen?e.webkitRequestFullscreen():e.msRequestFullscreen&&e.msRequestFullscreen()},e.closeFullscreen=function(){document.exitFullscreen?document.exitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitExitFullscreen?document.webkitExitFullscreen():document.msExitFullscreen&&document.msExitFullscreen()},e.parseURL=function(e){let t,n,o,a=document.createElement("a"),r={};for(a.href=e,t=a.search.replace(/^\?/,"").split("&"),o=0;o<t.length;o++)n=t[o].split("="),r[n[0]]=n[1];return{protocol:a.protocol,host:a.host,hostname:a.hostname,port:a.port,pathname:a.pathname,search:a.search,searchObject:r,hash:a.hash}},e.CheckChanged=function(e){},e.SelectAuthority=function(e){let t="- To be done -",n="- To be done -",o="- To be done -";const a=document.getElementById("AuthorityNotify"),r=document.getElementById("AuthorityNational"),l=document.getElementById("AuthorityWeather");"Iceland"===e&&(t="Operations Centre<br/>             The Icelandic Coastguard<br/>              P.O. 7120 127 Reykjavik<br/>             Tel:    +354-545 2100 (24 hr)<br/>             Fax:    +354-545 2001<br/>             Email:  sar@lhg.is<br/>             Web: www.lhg.is<br/>",n="Environmental Agency of Iceland (EAI) (Oil & HNS)<br/>             Suðurlandsbraut 24 108 Reykjavik<br/>             Tel:    +354-591 2000<br/>             Mobile: +354 822 4003<br/>             Fax:\t+354-591 2010<br/>             Email:  ust@ust.is<br/>             Web:\twww.ust.is<br/>"),a.innerHTML=t,r.innerHTML=n,l.innerHTML=o},String.prototype.replaceAll=function(e,t){let n=this;return n.replace(new RegExp(e,"g"),t)},e.ReplaceAll=String.prototype.replaceAll,e.drawSquare=function(e){let t={myBox:e},n=new ol.layer.Tile({extent:t.myBox,source:new ol.source.TileJSON({url:"https://api.tiles.mapbox.com/v3/mapbox.world-light.json?secure",crossOrigin:"anonymous"})});App4Sea.OpenLayers.Map.addLayer(n),me.LookAt(n)},e.loadXMLDoc=function(e){let t=new XMLHttpRequest;return t.open("GET",e,!1),t.send(),loadResonse(t)},e.loadResponse=function(e){let t=e.responseXML;return t},e.heatMap=function(e,t,n){const o=document.getElementById("titleHeatMap"),a=document.getElementById("blur"),r=document.getElementById("radius");o.innerHTML=n;const l=new ol.layer.Heatmap({source:new ol.source.Vector({crossOrigin:"anonymous",url:e,format:new ol.format.KML({extractStyles:!1})}),blur:parseInt(a.value,10),radius:parseInt(r.value,10)});return l.getSource().on("addfeature",function(e){const t=e.feature.get("name");if(t){const n=parseFloat(t.substr(2));e.feature.set("weight",n-5)}else{const t=parseFloat(e.feature.values_.SURFACE);e.feature.set("weight",t-33)}}),a.addEventListener("input",function(){l.setBlur(parseInt(a.value,10))},!1,{passive:!0}),r.addEventListener("input",function(){l.setRadius(parseInt(r.value,10))},!1,{passive:!0}),l},e.loadImage=function(e,t,n,o,a,r,l,i,p,s){o=o.replaceAll(/&amp;/,"&"),App4Sea.logging&&console.log("loadImage: "+o);let c=r,d=new ol.layer.Image({name:c,source:new ol.source.ImageStatic({url:o,imageExtent:t,crossOrigin:"anonymous"})});return d},e.alreadyLayer=function(e,t){let n=t.length;for(let o=0;o<n;o++)if(t[o].id===e)return o;return-1},e.alreadyActive=function(e,t){let n=t.array_,o=n.length;for(let t=0;t<o;t++)if(n[t].ol_uid===e)return t;return-1},e.supports_html5_storage=function(){try{return"localStorage"in window&&null!==window.localStorage}catch(e){return!1}},e.NoXML=function(e){let t,n=e.trim();return t=n.startsWith("<![CDATA[")?n.substr(9,n.length-12):n,t},e.allowDrop=function(e){e.preventDefault()},e.drag=function(e){App4Sea.logging&&console.log("Drag"),e.dataTransfer.setData("id",e.target.id),e.dataTransfer.setData("title",e.target.name),App4Sea.logging&&console.log(e.target.id),App4Sea.logging&&console.log(e.target.name)},e.drop=function(e){App4Sea.logging&&console.log("Drop"),e.preventDefault();let t=e.dataTransfer.getData("id"),n=e.dataTransfer.getData("title");App4Sea.logging&&console.log(t),App4Sea.logging&&console.log(n)},e.PutPlacemark=function(){for(var e=new ol.style.Style({image:new ol.style.Icon({anchor:[.5,46],anchorXUnits:"fraction",anchorYUnits:"pixels",opacity:.75,src:"https://www.freeiconspng.com/minicovers/file-light-bulb-yellow-icon-svg-2.png"})}),t=new ol.source.Vector({}),n=0;n<1;n++){var o=new ol.Feature({geometry:new ol.geom.Point(ol.proj.transform([360*Math.random()-180,180*Math.random()-90],"EPSG:4326","EPSG:3857")),name:"Null Island "+n,population:4e3,rainfall:500});t.addFeature(o)}var a=new ol.layer.Vector({source:t,style:e});App4Sea.OpenLayers.Map.addLayer(a)},e.PrintReport=function(){};let n=function(){d.remove("#ControlPlaceInMenu"),$(d).appendTo("#ControlPlaceInMap"),u.remove("#ControlPlaceInMenu"),$(u).appendTo("#ControlPlaceInMap"),m.remove("#ControlPlaceInMenu"),$(m).appendTo("#ControlPlaceInMap"),g.remove("#ControlPlaceInMenu"),$(g).appendTo("#ControlPlaceInMap"),y.remove("#ControlPlaceInMenu"),$(y).appendTo("#ControlPlaceInMap");const e="none"!==d.style.display,t="none"!==u.style.display,n="none"!==m.style.display,o="none"!==g.style.display,a="none"!==y.style.display;e||t||n||o||a?(s.style.visibility="visible",c.style.visibility="visible"):(s.style.visibility="hidden",c.style.visibility="hidden")},o=function(){d.remove("#ControlPlaceInMap"),$(d).appendTo("#ControlPlaceInMenu"),u.remove("#ControlPlaceInMap"),$(u).appendTo("#ControlPlaceInMenu"),m.remove("#ControlPlaceInMap"),$(m).appendTo("#ControlPlaceInMenu"),g.remove("#ControlPlaceInMap"),$(g).appendTo("#ControlPlaceInMenu"),y.remove("#ControlPlaceInMap"),$(y).appendTo("#ControlPlaceInMenu"),s.style.visibility="hidden",c.style.visibility="hidden"},a=function(e){let t=!0;return $(e+" li.jstree-open").length&&(t=!1),t};e.collapse_tree=function(e,t,n){const o=$(t);n?a(t)?(o[0].style.visibility="hidden",o[0].style.height=0):$(t).jstree(!1).close_all():"hidden"===o[0].style.visibility?(o[0].style.visibility="visible",o[0].style.height="100%"):$(t).jstree(!1).open_all()},e.section_toggle=function(t){const a=document.getElementById(t);if(null!==a&&"none"===a.style.display)if(e.w3_open(t),"MenuContainer"===t)o();else{const e=document.getElementById("MenuContainer");"block"===e.style.display?o():n()}else e.w3_close(t)},e.w3_open=function(e){const t=document.getElementById(e);if(null!==t&&(t.style.display="block"),"MenuContainer"===e&&($("#TreeMenu").jstree(!0).close_all(),o(),f.style.display="none",window.innerWidth<=500))for(let e=0;e<S.length;e++)S[e].style.display="none"},e.w3_close=function(e){const t=document.getElementById(e);if(null!==t&&(t.style.display="none"),"MenuContainer"===e){n(),f.style.display="block";for(let e=0;e<S.length;e++)S[e].style.display="block"}d.style.display,u.style.display,m.style.display,g.style.display;"HeatContainer"===e&&null!==d&&(d.style.display="none"),"AnimationContainer"===e&&null!==u&&(u.style.display="none"),"LogContainer"===e&&null!==g&&(g.style.display="none"),"MeasurementContainer"===e&&null!==m&&(m.style.display="none");let o=0;for(let e=0;e<s.children.length;e++)"none"!==s.children[e].style.display&&o++;1===o&&(s.style.visibility="hidden",c.style.visibility="hidden")},e.Base64Encode=function(e){let n,o,a,l,i,p,s,c="",d=0;for(e=r(e);d<e.length;)n=e.charCodeAt(d++),o=e.charCodeAt(d++),a=e.charCodeAt(d++),l=n>>2,i=(3&n)<<4|o>>4,p=(15&o)<<2|a>>6,s=63&a,isNaN(o)?p=s=64:isNaN(a)&&(s=64),c=c+t.charAt(l)+t.charAt(i)+t.charAt(p)+t.charAt(s);return c},e.Base64Decode=function(e){let n,o,a,r,i,p,s,c="",d=0;for(e=e.replace(/[^A-Za-z0-9\+\/\=]/g,"");d<e.length;)r=t.indexOf(e.charAt(d++)),i=t.indexOf(e.charAt(d++)),p=t.indexOf(e.charAt(d++)),s=t.indexOf(e.charAt(d++)),n=r<<2|i>>4,o=(15&i)<<4|p>>2,a=(3&p)<<6|s,c+=String.fromCharCode(n),64!==p&&(c+=String.fromCharCode(o)),64!==s&&(c+=String.fromCharCode(a));return c=l(c),c};let r=function(e){e=e.replace(/\r\n/g,"\n");let t="";for(let n=0;n<e.length;n++){let o=e.charCodeAt(n);o<128?t+=String.fromCharCode(o):o>127&&o<2048?(t+=String.fromCharCode(o>>6|192),t+=String.fromCharCode(63&o|128)):(t+=String.fromCharCode(o>>12|224),t+=String.fromCharCode(o>>6&63|128),t+=String.fromCharCode(63&o|128))}return t},l=function(e){let t="",n=0,o=c1=c2=0;for(;n<e.length;)o=e.charCodeAt(n),o<128?(t+=String.fromCharCode(o),n++):o>191&&o<224?(c2=e.charCodeAt(n+1),t+=String.fromCharCode((31&o)<<6|63&c2),n+=2):(c2=e.charCodeAt(n+1),c3=e.charCodeAt(n+2),t+=String.fromCharCode((15&o)<<12|(63&c2)<<6|63&c3),n+=3);return t};e.clearLog=function(){const e=document.getElementById("Log");e.innerHTML=""};let i=function(e){e=e||window.event;let t=["X","Y"];if(e.clientX)t.X=e.clientX,t.Y=e.clientY;else{let n=e.touches[0],o=n.pageX,a=n.pageY;t.X=o,t.Y=a}return t},p=function(e){function t(e){if(e=e||window.event,"DragHandle"===e.target.id){e.preventDefault();let t=i(e);c=t.X,d=t.Y}}function n(e){e=e||window.event,"DragHandle"===e.target.id&&(e.preventDefault(),r(e))}function o(e){e=e||window.event,"DragHandle"===e.target.id&&e.preventDefault()}function a(e){if(e=e||window.event,"DragHandle"===e.target.id){e.preventDefault();let t=i(e);c=t.X,d=t.Y,document.onmouseup=l,document.onmousemove=r}}function r(t){t=t||window.event,t.preventDefault();let n=i(t);window.innerWidth>500?(p=c-n.X,c=n.X,e.style.left=e.offsetLeft-p+"px"):(p=c-n.X,c=n.X,e.style.left="0px");let o=e.clientWidth/2+.5;e.offsetLeft-o>window.innerWidth-40?e.style.left=window.innerWidth-40+o+"px":e.offsetLeft-o+e.clientWidth<40&&(e.style.left=40-e.clientWidth+o+"px"),s=d-n.Y,d=n.Y,e.style.top=e.offsetTop-s+"px"}function l(e){e=e||window.event,document.onmouseup=null,document.onmousemove=null}let p=0,s=0,c=0,d=0;e.addEventListener("touchstart",t,!1,{passive:!1}),e.addEventListener("touchmove",n,!1,{passive:!1}),e.addEventListener("touchend",o,!1,{passive:!1}),e.onmousedown=a,e.touchstart=t};e.SpotFromExtent=function(e){let t={lat:lat,long:long};return t.lat=e[3]-e[1],t.long=e[4]-e[2],t},e.FlyTo=function(e,t){function n(e){--r,l||0!==r&&e||(l=!0,t(e))}if("Stopped"!==App4Sea.Animation.getAnimationState())return;let o=2e3,a=view.getZoom(),r=2,l=!1;view.animate({center:e,duration:o},n),view.animate({zoom:a-1,duration:o/2},{zoom:a,duration:o/2},n)};const s=document.getElementById("ControlPlaceInMap"),c=document.getElementById("DragHandle"),d=document.getElementById("HeatContainer"),u=document.getElementById("AnimationContainer"),g=document.getElementById("LogContainer"),m=document.getElementById("MeasurementContainer"),y=document.getElementById("OperationContainer"),f=document.getElementById("ToolButtonsPlaceInMap"),S=document.getElementsByClassName("ol-control");return p(s),e}()),App4SeaWeather=(App4Sea=App4Sea||{},function(){"use strict";var e={NotWorking:function(e){var t=e.coordinate,n=document.getElementById("popup-content"),o="<div id='openweathermap-widget-15' style='zoom: 0.8'></div>";n.innerHTML=o,window.myWidgetParam?window.myWidgetParam:window.myWidgetParam=[],window.myWidgetParam.push({id:15,cityid:"3413829",appid:"1326faa296b7e865683b67cdf8e5c6e4",units:"metric",containerid:"openweathermap-widget-15"}),function(){var e=document.createElement("script");e.async=!0,e.charset="utf-8",e.src="//openweathermap.org/themes/openweathermap/assets/vendor/owm/js/weather-widget-generator.js";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)}(),App4Sea.PopUps.overlayLayerPopUp.setPosition(t)},loadCityWeather:function(e,t){var n=document.getElementById("popup-content"),o=App4Sea.OpenLayers.Map.getView().getCenter(),a="<div id='openweathermap-widget-15' style='zoom: 0.8'></div>";n.innerHTML=a,window.myWidgetParam?window.myWidgetParam:window.myWidgetParam=[],window.myWidgetParam.push({id:15,cityid:"3413829",appid:"1326faa296b7e865683b67cdf8e5c6e4",units:"metric",containerid:"openweathermap-widget-15"}),function(){var e=document.createElement("script");e.async=!0,e.charset="utf-8",e.src="//openweathermap.org/themes/openweathermap/assets/vendor/owm/js/weather-widget-generator.js";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)}(),App4Sea.PopUps.overlayLayerPopUp.setPosition(o)},loadWeather:function(e,t){App4Sea.logging&&console.log("loadWeather: "+t+" from "+e);for(var n=ol.extent.getWidth(App4Sea.mapExtent)/256/4,o=new Array(App4Sea.maxZoom-App4Sea.minZoom+1),a=0,r=o.length;a<r;++a)o[a]=n/Math.pow(2,a);var l=new ol.tilegrid.TileGrid({extent:App4Sea.mapExtent,origin:[App4Sea.mapExtent[0],App4Sea.mapExtent[1]],resolutions:o,projection:App4Sea.OpenLayers.prefViewProj,tileSize:[256,256]}),i=new ol.layer.Tile({name:t,preload:0,opacity:.8,extent:App4Sea.mapExtent,minResolution:o[o.length-1],maxResolution:o[0],tileGrid:l,source:new ol.source.XYZ({crossOrigin:"anonymous",attributions:['&copy; <a href="https://openweathermap.org/">Open Weather Map</a>'],url:e})});return i}};return e}());App4Sea=function(){"use strict";let e={prefProj:"EPSG:4326",prefViewProj:"EPSG:3857"};return e.mapCenter=ol.proj.transform([-3,65],e.prefProj,e.prefViewProj),e.mapExtent=ol.proj.transformExtent([-180,90,180,-90],e.prefProj,e.prefViewProj),e.minZoom=2,e.maxZoom=18,e.startZoom=4,e.logging=5,e.useIconsInMenu=!0,e.disableSubItems=!1,e.Animation=App4SeaAnimation||{},e.KML=App4SeaKML||{},e.Measure=App4SeaMeasure||{},e.OpenLayers=App4SeaOpenLayers||{},e.PopUps=App4SeaPopUps||{},e.TreeInfo=App4SeaTreeInfo||{},e.TreeMenu=App4SeaTreeMenu||{},e.Utils=App4SeaUtils||{},e.Weather=App4SeaWeather||{},e.logging&&console.log("Windows width is "+window.innerWidth),e}();